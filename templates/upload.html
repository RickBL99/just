<!DOCTYPE html>


<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <meta charset="UTF-8">
    <title>View All Metadata</title>
    <link rel="shortcut icon" type="image/jpg" href="/favicon.ico"/>
    <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
    <script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
    <script src="/static/sorttable.js" type="text/javascript"></script>
   <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" integrity="sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp" crossorigin="anonymous">
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"> </script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</head>

<style>
  /* Working Modal */
.modal-backdrop {
  display: none;
}
.modal.fade:not(.show) .modal-dialog {
  -webkit-transform: translate(0, -25%);
  transform: translate(0, -25%);
}
.modal.fade.show .modal-dialog {
  -webkit-transform: translate(0, 0);
  transform: translate(0, 0);
}
</style>

<style>
.logo {
  width: 200px;
  position: relative;
  top: 10%;
  left: 40%;
  padding-top: 50px;
}
</style>

<html>
  <head>
    <title>Superstock Upload</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css">
  </head>
<body style="background-color: rgb(248,249,250)">
<!--   <div class="container">
    <img src="logo.png" alt="Superstock Logo" class="logo">
  </div> -->
</body>



      <h1 class="text-center my-5">Welcome to ... <i>Just The Meta.</i></h1>
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div id="drop-area" class="border border-secondary p-5">
            <p class="text-center mb-0">Drag and drop up to 30 images or <b>click</b> to select a file(s). Uploading will begin within 10 seconds.</p>
            
            <input type="file" id="file-input" class="d-none" multiple>
          </div>
<!--           <div class="text-center mt-3">
            <p id="status"></p>

       <button type="button" id="view-uploaded-files-button" class="btn btn-block btn-primary mt-3" onclick="submitForm('/api/get_upload_list')">Check / Delete Uploaded File(s)</button>

      <button type="button" id="get-meta-button" class="btn btn-block btn-primary mt-3" onclick="submitForm('/api/getmetalist')">See / Edit Metadata Information</button>
      <button type="button" id="leave-note-button" class="btn btn-block btn-primary mt-3" data-toggle="modal" data-target="#note-modal">Leave Note For Creative Team</button>
 <button type="button" id="finalize_submission" class="btn btn-block btn-success mt-3" data-toggle="modal" onclick="finalizeSubmission()">Finalize Submission</button> -->

      <a href="/api/homepage" class="btn btn-block btn-primary mt-3">See The Data</a>







            <div></div>
          </div>
          <br>
        </div>
      </div>




      <div class="row justify-content-center">



        <div class="col-md-6">
          <ul>
          <br>

    <li>You can upload JPEG, PNG, TIFF, GIF, BMP, PSD, RAW, DNG, CR2, NEF, and SR2 files.  If there's metadata, we'll show it to you.</li>
  
  <br>

    <li>This uploader relies on Chrome extensions. You can download Chrome <a href="https://google.com/chrome">HERE.</a></li>

    </ul>


<br>
<br>


      <br>

      <i><p class="text-center mb-0"><a href="https://superstock.com">Brought to you by SuperStock.  Interested in licensing your content, let's talk!</a></p></i>

    </div> 


<!-- Working Modal -->
<div class="modal fade" id="working-modal" tabindex="-1" role="dialog" aria-labelledby="working-modal-label" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="working-modal-label">Working...</h5>
      </div>
      <div class="modal-body">
        <p>Please wait while your pix are being uploaded.</p>
      </div>
    </div>
  </div>
</div>









<script>

function finalizeSubmission() {
  const confirmMessage = "Are you ready to finalize submission?  This will put your images and and notes for creative team into a final folder and erase images from the staging area.";
  const confirmed = confirm(confirmMessage);
  if (confirmed) {
    // Show the working modal
    $('#working-modal').modal('show');
    fetch("/api/finalize", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        // include any data you want to send with the request
      })
    })
      .then(response => {
        if (!response.ok) {
          throw new Error("Network response was not ok");
        }
        // do something with the successful response
        // Hide the working modal
        $('#working-modal').modal('hide');
      })
      .catch(error => {
        console.error("Error:", error);
        // handle the error
        // Hide the working modal
        $('#working-modal').modal('hide');
      });
  }
}

</script>










<script>
  var dropArea = document.getElementById('drop-area');

  ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
    dropArea.addEventListener(eventName, preventDefaults, false);
  });

  function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
  }

  dropArea.addEventListener('drop', handleDrop, false);

  function handleDrop(e) {
    var dt = e.dataTransfer;
    var files = dt.files;

    handleFiles(files);
  }

function resetStatus() {
  document.getElementById("status").innerHTML = "";}


function handleFiles(files) {
  var formData = new FormData();
  var unsupportedTypeAlertShown = false; // Flag to keep track of whether the unsupported type alert has been displayed
  var hasUnsupportedFiles = false; // Flag to keep track of whether there are unsupported files

  for (var i = 0; i < files.length; i++) {
    if (files[i].type == "") {
      alert("Only individual files please. Folders are not allowed.");
      return;
    }
    // Warn for file types other than .jpg, .jpeg, .mov, .mp4, .xls, and .xlsx
    if (files[i].type !== "image/jpeg" && files[i].type !== "image/jpg" && files[i].type !== "video/quicktime" && files[i].type !== "application/postscript" && files[i].type !== "image/x-eps" && files[i].type !== "video/mp4" && files[i].type !== "application/vnd.ms-excel" && files[i].type !== "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet") {
      if (!unsupportedTypeAlertShown) {
        alert("Warning: Only .jpg, .jpeg, .mov, .mp4, .xls .eps and .xlsx files are currently supported.");
        unsupportedTypeAlertShown = true; // Set flag to true to indicate that the alert has been displayed
      }
      hasUnsupportedFiles = true; // Set flag to true to indicate that there are unsupported files
    }
    console.log(files[i].type);
    formData.append("files", files[i]);
  }

  if (!hasUnsupportedFiles) {
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "/api/upload");

    // Progress bar
    var totalFiles = files.length;
    var progress = 0;
    var progressInterval = setInterval(function () {
      if (progress >= 100) {
        clearInterval(progressInterval);
      }
      else {
        progress += 100 / totalFiles;
        document.getElementById("status").textContent = "Uploading file(s): " + Math.round(progress) + "%";
      }
    }, 1000);

    xhr.addEventListener("load", function () {
      clearInterval(progressInterval);

      if (xhr.status === 200) {
        document.getElementById("status").innerHTML = '<div class="alert alert-success" role="alert">File(s) uploaded successfully! Building Index.</div>';
      } else {
        document.getElementById("status").innerHTML = '<div class="alert alert-danger" role="alert">Error uploading file(s)!</div>';
      }
    });

    // Send form data
    xhr.send(formData);

    // Log upload
    for (var i = 0; i < files.length; i++) {
      logger.info("Uploading file %s (%s bytes)", files[i].name, files[i].size);
    }
  }
}

function resetUploadForm() {
  document.getElementById("status").textContent = "";
  document.getElementById("upload-form").reset();
}



  // Click event for file input
  var fileInput = document.getElementById('file-input');
  dropArea.addEventListener('click', function () {
    fileInput.click();
  });

  fileInput.addEventListener('change', function () {
    handleFiles(fileInput.files);
  });

function submitForm(actionUrl) {
  var form = document.createElement("form");
  form.setAttribute("method", "POST");
  form.setAttribute("action", actionUrl);

  document.body.appendChild(form);
  form.submit();
}

setTimeout(function() {
  document.getElementById("status").innerHTML = "";
}, 10000);


</script>
</body>

<!-- Modal -->
<div class="modal fade" id="note-modal" tabindex="-1" role="dialog" aria-labelledby="note-modal-label" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="note-modal-label">Leave Note For Creative Team</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <textarea id="note-text" class="form-control" placeholder="Write your note here..."></textarea>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="save-note-button">Save Note</button>
      </div>
    </div>
  </div>
</div>

<script>
  document.getElementById('save-note-button').addEventListener('click', function() {
  var noteText = document.getElementById('note-text').value;
  
  // Make the POST request
  var xhr = new XMLHttpRequest();
  xhr.open('POST', '/api/leavenote');
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.onload = function() {
    if (xhr.status === 200) {
      alert('Note saved successfully!');
      // Hide the modal
      $('#note-modal').modal('hide');
    } else {
      alert('Failed to save note!');
    }
  };
  xhr.send(JSON.stringify({note: noteText}));
});
</script>
</html>